import{r as e,u as a,j as t,am as r,X as s,an as l,w as i,ao as n,af as d,ag as c,ap as o,a3 as m,m as x,aq as b}from"./vendor.CpgnmK0_.js";import{C as u}from"./CTAButton.2c-6-j9U.js";import{b as g,d as h}from"./index.Dm7KaAjC.js";const f=[{type:"problem",icon:i},{type:"idea",icon:n},{type:"praise",icon:l}];function p({open:i,onClose:n,section:p="default"}){const[k,y]=e.useState(1),[v,j]=e.useState(null),[N,w]=e.useState(""),[S,C]=e.useState(""),[$,z]=e.useState(!1),[F,T]=e.useState(!1),[E,P]=e.useState(!1),[_,q]=e.useState("idle"),[B,I]=e.useState(!1),R=e.useRef(null),{t:D,i18n:Y}=a(),{playSubmitSuccess:Z,playSubmitError:A,playFieldFocus:G}=g(),{playButtonClick:K}=h();e.useEffect((()=>{if("success"===_){const e=setTimeout((()=>{q("idle")}),4e3);return()=>clearTimeout(e)}}),[_]);const L=N.trim().length>=5,M=!S||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S),Q=L&&!F,U=async e=>{e.preventDefault(),T(!0),q("idle");try{await b.send("service_4z3a60b","template_nc73bg4",{from_name:`Feedback Portfolio - ${v}`,from_email:S||"tbisp0@hotmail.com",message:`Type: ${v}\nSection: ${p}\n\nMessage:\n${N}`,to_email:"tbisp0@hotmail.com",subject:`Portfolio Feedback - ${v} (${p})`,reply_to:S||"tbisp0@hotmail.com"},"eRzZy4gTZ2NXGjFKz"),q("success"),P(!0),Z()}catch(a){console.error("Error sending feedback:",a),q("error"),A()}finally{T(!1)}},X=()=>{y(1),j(null),w(""),C(""),z(!1),P(!1),q("idle"),I(!1),n()};return t.jsx(r,{open:i,onClose:()=>{1===k||""===N.trim()&&""===S.trim()?X():n()},initialFocus:R,className:"fixed z-50 inset-0 overflow-y-auto",children:t.jsxs("div",{className:"flex items-center justify-center min-h-screen px-2",children:[t.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm dark:bg-black/50","aria-hidden":"true"}),t.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-sm w-full mx-auto p-0 z-10 border border-slate-100 dark:border-gray-700",children:[t.jsx("button",{onClick:X,className:"absolute top-3 right-3 p-2 rounded-full hover:bg-slate-100 dark:hover:bg-gray-700 focus-visible:ring-2 focus-visible:ring-blue-700 text-gray-700 dark:text-gray-300","aria-label":D("feedback.close"),children:t.jsx(s,{className:"w-5 h-5"})}),t.jsx("div",{className:"p-6 sm:p-8 flex flex-col gap-4",children:E?t.jsxs("div",{className:"flex flex-col items-center py-8",children:[t.jsx(l,{className:"w-12 h-12 text-green-600 dark:text-green-400 mb-4"}),t.jsx("div",{className:"text-center max-w-xs",children:t.jsx("p",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-2",children:D("feedback.thankYou")})}),t.jsx(u,{onClick:X,variant:"primary",size:"md",className:"mt-6",children:D("feedback.close")})]}):1===k?t.jsxs(t.Fragment,{children:[t.jsx(r.Title,{className:"text-lg sm:text-xl font-bold mb-4 text-gray-900 dark:text-white text-center",children:D("feedback.typeQuestion")}),t.jsx("div",{className:"flex flex-col gap-3",children:f.map((e=>t.jsx(u,{variant:v===e.type?"primary":"ghost",size:"md",icon:e.icon,iconPosition:"left",onClick:()=>{j(e.type),y(2),K()},className:"justify-center py-3",children:D(`feedback.${e.type}`)},e.type)))})]}):t.jsxs("form",{onSubmit:U,className:"flex flex-col gap-4 mt-2",children:[t.jsx(r.Title,{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white text-center mb-2",children:D(`feedback.${v}Title`)||D("feedback.defaultTitle")}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-300 text-center mb-1",children:D(`feedback.${v}Instruction`)||D("feedback.defaultInstruction")}),t.jsxs("div",{className:"relative",children:[t.jsx("textarea",{className:"w-full rounded-lg border-2 p-3 min-h-[90px] text-base transition-all focus-visible:ring-2 focus-visible:ring-blue-700 outline-none resize-none bg-slate-50 dark:bg-gray-700 dark:text-white pr-10 "+(B&&!L?"border-red-500 focus:ring-red-500":B&&L?"border-green-500 focus:ring-green-500":"border-slate-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500"),placeholder:D(`feedback.${v}Placeholder`)||D("feedback.defaultPlaceholder"),value:N,onChange:e=>w(e.target.value),onBlur:()=>I(!0),onFocus:()=>G(),required:!0,autoFocus:!0,maxLength:1e3,"aria-invalid":B&&!L,"aria-describedby":"feedback-message-help"}),B&&!L&&t.jsx(s,{className:"absolute right-3 top-3 w-5 h-5 text-red-500 dark:text-red-400","aria-hidden":"true"}),B&&L&&t.jsx(d,{className:"absolute right-3 top-3 w-5 h-5 text-green-500 dark:text-green-400","aria-hidden":"true"})]}),B&&!L?t.jsxs("div",{id:"feedback-message-help",className:"text-xs text-red-500 dark:text-red-400 flex items-center gap-1 mb-1",role:"alert",children:[t.jsx(c,{className:"w-3 h-3","aria-hidden":"true"}),D("contact.errors.messageRequired")]}):t.jsx("div",{id:"feedback-message-help",className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:D("feedback.minimumCharacters")}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{id:"show-email",type:"checkbox",checked:$,onChange:e=>z(e.target.checked),className:"accent-blue-700"}),t.jsx("label",{htmlFor:"show-email",className:"text-sm text-gray-700 dark:text-gray-300 cursor-pointer select-none",children:D("feedback.includeEmail")})]}),$&&t.jsxs("div",{className:"relative",children:[t.jsx("input",{className:`rounded-lg border-2 p-2 text-base transition-all focus-visible:ring-2 focus-visible:ring-blue-700 outline-none bg-slate-50 dark:bg-gray-700 dark:text-white w-full pr-10\n                        ${S.length>0?M?"border-green-500":"border-red-500":"border-slate-300 dark:border-gray-600"}\n                      `,type:"email",placeholder:"E-mail",value:S,onChange:e=>C(e.target.value),"aria-invalid":S.length>0&&!M,"aria-describedby":"feedback-email-help"}),S.length>0&&!M&&t.jsx(s,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-red-500 dark:text-red-400","aria-hidden":"true"}),S.length>0&&M&&t.jsx(d,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-500 dark:text-green-400","aria-hidden":"true"})]}),t.jsx("a",{href:"/portfolio/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-700 dark:text-blue-400 underline mb-2",children:D("feedback.privacyPolicy")}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx(u,{onClick:()=>{U({preventDefault:()=>{}})},variant:"primary",size:"md",icon:o,iconPosition:"left",disabled:!Q,loading:F,className:"flex-1",children:D(F?"feedback.sending":"feedback.send")}),t.jsx(u,{onClick:()=>{y(1),K()},variant:"ghost",size:"md",icon:m,iconPosition:"left",className:"flex-1",children:D("feedback.back")})]}),"success"===_&&t.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4 flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg text-green-700 dark:text-green-300",role:"status","aria-live":"polite",children:[t.jsx(d,{className:"w-4 h-4 flex-shrink-0","aria-hidden":"true"}),t.jsx("span",{className:"text-sm font-medium text-left",children:D("feedback.thankYou")})]}),"error"===_&&t.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4 flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400",role:"alert","aria-live":"assertive",children:[t.jsx(c,{className:"w-4 h-4 flex-shrink-0","aria-hidden":"true"}),t.jsx("span",{className:"text-sm font-medium text-left",children:"en-US"===Y.language?"Error sending feedback. Please try again.":"es-ES"===Y.language?"Error al enviar feedback. Int√©ntalo de nuevo.":"Erro ao enviar feedback. Tente novamente."})]})]})})]})]})})}export{p as default};
